<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Create your account</title>

  <style>
    :root{
      --text:#ffffff;
      --muted:rgba(255,255,255,.78);
      --card: rgba(15,18,24,.55);
      --card2: rgba(15,18,24,.38);
      --line: rgba(255,255,255,.14);
      --shadow: 0 22px 70px rgba(0,0,0,.55);
      --radius: 18px;
    }

    html, body { height:100%; }
    body{
      margin:0;
      font-family: Arial, sans-serif;
      color: var(--text);
      overflow-x:hidden;
      background:#0b0d12;
    }

    body::before{
      content:"";
      position:fixed;
      inset:0;
      z-index:-2;
      background: url("assets/signup-hero.webp") center/cover no-repeat;
      transform: scale(1.03);
    }

    body::after{
      content:"";
      position:fixed;
      inset:0;
      z-index:-1;
      background:
        radial-gradient(900px 600px at 20% 20%, rgba(0,0,0,.35), rgba(0,0,0,.72) 70%),
        linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,.68));
    }

    .wrap{max-width:520px;margin:80px auto;padding:0 20px;text-align:center;}
    h1{font-size:40px;margin:0 0 10px;font-weight:900;}
    .sub{color:var(--muted);margin:0 0 22px;font-size:14px;}

    .card{
      border-radius: var(--radius);
      padding:22px;
      background: linear-gradient(180deg, var(--card), var(--card2));
      border:1px solid var(--line);
      box-shadow:var(--shadow);
    }

    label{display:block;font-size:13px;margin:12px 0 6px;font-weight:700;}
    input{
      width:100%;padding:12px;border-radius:12px;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.18);
      color:#fff;
    }

    button{
      width:100%;margin-top:16px;padding:12px;border-radius:12px;
      font-weight:900;background:#fff;color:#000;cursor:pointer;
    }

    .msg{margin-top:12px;font-size:13px;min-height:18px;}
    .msg.ok{color:#bff0bf;}
    .msg.err{color:#ffb4b4;}

    .row{display:flex;justify-content:space-between;margin-top:14px;font-size:13px;}
    a{color:#fff;text-decoration:none;border-bottom:1px solid rgba(255,255,255,.3);}

    @media(max-width:640px){
      .wrap{margin:26px 16px;}
      h1{font-size:32px;}
    }
  </style>
</head>

<body>
<div class="wrap">
<h1>Create your account</h1>
<p class="sub">Email + password. Your draft will carry over.</p>

<div class="card">

<label>Email</label>
<input id="email" type="email" placeholder="you@example.com">

<label>Password</label>
<input id="password" type="password">

<button id="btn">Sign up</button>
<div id="msg" class="msg"></div>

<div class="row">
<div>Already have an account?</div>
<a href="login.html">Log in</a>
</div>

</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="./account.js?v=3" defer></script>

<script>
const emailEl=document.getElementById("email");
const passEl=document.getElementById("password");
const btn=document.getElementById("btn");
const msg=document.getElementById("msg");

function setMsg(t,c){msg.textContent=t||"";msg.className="msg "+(c||"");}

async function waitForAccount(){
 while(!window.AuthoredAccount) await new Promise(r=>setTimeout(r,30));
}

btn.onclick=async()=>{
 setMsg("");
 const email=emailEl.value.trim();
 const password=passEl.value;
 if(!email||!password){setMsg("Enter email + password","err");return;}

 btn.disabled=true;

 try{
   await waitForAccount();

   const { error } = await window.AuthoredAccount.signUp(email,password);

   if(error){
     setMsg(error.message,"err");
     btn.disabled=false;
     return;
   }

   setMsg("Account created. Check your email to verify before logging in.","ok");

 }catch(e){
   setMsg("Signup failed.","err");
 }

 btn.disabled=false;
};
</script>

</body>
</html>
